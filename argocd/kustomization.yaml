apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: argocd
resources:
  - namespace.yaml
  # v1.5.7
  - github.com/argoproj/argo-cd/manifests/cluster-install?ref=e7d1553cfc10e059acd39914a35ed3450eab7574
  - ingress.yaml
  - argo-cd-service-monitor.yaml
  - argocd-notifications/
  # Projects
  - projects/default.yaml
  # Applications to deploy
  - applications/argocd.yaml
  - applications/book.yaml
  - applications/cert-manager.yaml
  - applications/cert-manager-issuers.yaml
  - applications/external-dns.yaml
  - applications/ingress-nginx.yaml
  - applications/ircd.yaml
  - applications/monitoring.yaml
  - applications/userdb-api.yaml
  - applications/webirc.yaml
patches:
  - argo-cd-repo-server-ksops-patch.yaml
  - argo-cd-allow-alpha-plugins-patch.yaml
  - argo-cd-import-pgp-key.yaml
  - argo-cd-repository-credentials-patch.yaml
  - argo-cd-rbac.yaml
  - users.yaml
images:
  - name: argoproj/argocd:v1.5.7
    digest: sha256:bc6ede4f7c371a09eb9647e9037396161414a0c22959e5f09c645f9a5fe5d917
  - name: quay.io/dexidp/dex:v2.22.0
    digest: sha256:01e996b4b60edcc5cc042227c6965dd63ba68764c25d86b481b0d65f6e4da308
  - name: redis:5.0.3
    digest: sha256:4be7fdb131e76a6c6231e820c60b8b12938cf1ff3d437da4871b9b2440f4e385
  - name: viaductoss/ksops:v2.1.1-go-1.14
    digest: sha256:47203d9b5538f11f16073ee0f3fd4ab99a2254188cfc043895ff65a663b06095
generators:
  - secret-generator.yaml
replicas:
- name: argocd-server
  count: 3
